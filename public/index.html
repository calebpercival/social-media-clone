<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
    <script src="js/callApi.js"></script>
    <title>Home page</title>
</head>

<body>
    <h1>Home page</h1>
    <a id="login" href="/login.html">Login</a>
    <a id="logout" href="#" onclick="logout()" class="hidden">Logout</a>
    <script>
        function logout(){ //function logs the user out and removes the token
            sessionStorage.removeItem('token') //removes token from session storage
            window.location = "/index.html" //navigates back to home page
        }

        addEventListener('DOMContentLoaded', (event) => { //runs when html is loaded
            let loggedIn = window.sessionStorage.getItem('token') //get token from session storage
            
            if(loggedIn){ //if token is found 
                document.getElementById('login').classList.add('hidden') //remove login link
                document.getElementById('logout').classList.remove('hidden') //show logout link

                let text = '<br>' + 'Currently logged in as ' + sessionStorage.getItem('username')
                let body = document.getElementsByTagName('body')[0]
                body.insertAdjacentHTML('beforeend', text)

            }
            else{ //else if token is not found
                document.getElementById('logout').classList.add('hidden') //remove logout link
                document.getElementById('login').classList.remove('hidden') //show login link
            }
        })

        callApi("/api/getPost",{post_id: 1}).then(
            function(response) {
                console.log(response)
            }
        )
    </script>
</body>

</html>
