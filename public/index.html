<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style/main.css">
    <script src="js/callApi.js"></script>
    <script src="js/logout.js"></script>
    <title>Home page</title>
</head>

<body>
    <h1>Home page</h1>
    <a id="login" href="/login.html">Login</a>
    <a id="newPost" href="/newPost.html">New Post</a>
    <a id="logout" href="#" onclick="logout()" class="hidden">Logout</a>
    <script>

        addEventListener('DOMContentLoaded', (event) => { //runs when html is loaded
            let loggedIn = window.sessionStorage.getItem('token') //get token from session storage
            
            if(loggedIn){ //if token is found 
                document.getElementById('login').classList.add('hidden') //remove login link
                document.getElementById('logout').classList.remove('hidden') //show logout link
                document.getElementById('newPost').classList.remove('hidden')

                let text = '<br>' + 'Currently logged in as ' + sessionStorage.getItem('username')
                let body = document.getElementsByTagName('body')[0]
                body.insertAdjacentHTML('beforeend', text)

            }
            else{ //else if token is not found
                document.getElementById('logout').classList.add('hidden') //remove logout link
                document.getElementById('login').classList.remove('hidden') //show login link
                document.getElementById('newPost').classList.add('hidden')
            }
        })

        callApi("/api/getPost",{post_id: 1}).then(
            function(response) {
                console.log(response)
            }
        )
    </script>
</body>
<!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js" integrity="sha384-W8fXfP3gkOKtndU4JGtKDvXbO53Wy8SZCQHczT5FMiiqmQfUpWbYdTil/SxwZgAN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.min.js" integrity="sha384-skAcpIdS7UcVUC05LJ9Dxay8AXcDYfBJqt1CJ85S/CFujBsIzCIv+l9liuYLaMQ/" crossorigin="anonymous"></script> -->
</html>
